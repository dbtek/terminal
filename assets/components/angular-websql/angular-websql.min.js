/* angular-websql - Helps you generate and run websql queries with angular services. */
"use strict";angular.module("angular-websql",[]).factory("$webSql",[function(){return{openDatabase:function(e,t,n,r){try{var i=openDatabase(e,t,n,r);if(typeof openDatabase=="undefined")throw"Browser does not support web sql";return{executeQuery:function(e,t){i.transaction(function(n){n.executeSql(e,[],function(e,n){if(t)t(n)})});return this},insert:function(e,t,n){var r="INSERT INTO `{tableName}` ({fields}) VALUES({values}); ";var i="",s="";for(var o in t){i+=Object.keys(t)[Object.keys(t).length-1]==o?"`"+o+"`":"`"+o+"`, ";s+=Object.keys(t)[Object.keys(t).length-1]==o?"'"+t[o]+"'":"'"+t[o]+"', "}this.executeQuery(this.replace(r,{"{tableName}":e,"{fields}":i,"{values}":s}),n);return this},update:function(e,t,n,r){var i="UPDATE `{tableName}` SET {update} WHERE {where}; ";var s="";for(var o in t){s+="`"+o+"`='"+t[o]+"'"}var u=this.whereClause(n);this.executeQuery(this.replace(i,{"{tableName}":e,"{update}":s,"{where}":u}),r);return this},del:function(e,t,n){var r="DELETE FROM `{tableName}` WHERE {where}; ";var i=this.whereClause(t);this.executeQuery(this.replace(r,{"{tableName}":e,"{where}":i}),n);return this},select:function(e,t,n){var r="SELECT * FROM `{tableName}` WHERE {where}; ";var i=this.whereClause(t);this.executeQuery(this.replace(r,{"{tableName}":e,"{where}":i}),n);return this},selectAll:function(e,t){this.executeQuery("SELECT * FROM `"+e+"`; ",t);return this},whereClause:function(e,t){var n="";for(var r in e){n+=typeof e[r]==="object"?typeof e[r]["union"]==="undefined"?typeof e[r]["value"]==="string"&&e[r]["value"].match(/NULL/ig)?"`"+r+"` "+e[r]["value"]:"`"+r+"` "+e[r]["operator"]+" '"+e[r]["value"]+"'":typeof e[r]["value"]==="string"&&e[r]["value"].match(/NULL/ig)?"`"+r+"` "+e[r]["value"]+" "+e[r]["union"]+" ":"`"+r+"` "+e[r]["operator"]+" '"+e[r]["value"]+"' "+e[r]["union"]+" ":typeof e[r]==="string"&&e[r].match(/NULL/ig)?"`"+r+"` "+e[r]:"`"+r+"`='"+e[r]+"'"}return n},replace:function(e,t,n){for(var r in t){e=e.replace(new RegExp(r,"ig"),t[r])}return e},createTable:function(e,t,n){var r="CREATE TABLE IF NOT EXISTS `{tableName}` ({fields}); ";var i=[];var s="";for(var o in t){var u="{type} {null}";s+="`"+o+"` ";for(var a in t[o]){u=u.replace(new RegExp("{"+a+"}","ig"),t[o][a])}s+=u;if(typeof t[o]["default"]!=="undefined"){s+=" DEFAULT "+t[o]["default"]}if(typeof t[o]["primary"]!=="undefined"){s+=" PRIMARY KEY"}if(typeof t[o]["auto_increment"]!=="undefined"){s+=" AUTOINCREMENT"}if(Object.keys(t)[Object.keys(t).length-1]!=o){s+=","}if(typeof t[o]["primary"]!=="undefined"&&t[o]["primary"]){i.push(o)}}var f={tableName:e,fields:s};for(var l in f){r=r.replace(new RegExp("{"+l+"}","ig"),f[l])}this.executeQuery(r,n);return this},dropTable:function(e,t){this.executeQuery("DROP TABLE IF EXISTS `"+e+"`; ",t);return this}}}catch(s){console.error(s)}}}}])